<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Full Example · MixedModelsSim.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">MixedModelsSim.jl</span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li class="is-active"><a class="tocitem" href>Full Example</a><ul class="internal"><li><a class="tocitem" href="#Assemble-the-Design"><span>Assemble the Design</span></a></li><li><a class="tocitem" href="#Assemble-the-Random-Effects"><span>Assemble the Random Effects</span></a></li><li><a class="tocitem" href="#Assemble-the-Fixed-Effects"><span>Assemble the Fixed Effects</span></a></li><li><a class="tocitem" href="#Simulate"><span>Simulate</span></a></li><li><a class="tocitem" href="#See-your-power-and-profit!"><span>See your power and profit!</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Full Example</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Full Example</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/RePsychLing/MixedModelsSim.jl/blob/master/docs/src/simulation.md#L" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Simulating-an-Experiment-from-Scratch"><a class="docs-heading-anchor" href="#Simulating-an-Experiment-from-Scratch">Simulating an Experiment from Scratch</a><a id="Simulating-an-Experiment-from-Scratch-1"></a><a class="docs-heading-anchor-permalink" href="#Simulating-an-Experiment-from-Scratch" title="Permalink"></a></h1><p>Here is a worked example of simulating a partially crossed design from scratch.</p><p>First, some setup:</p><pre><code class="language-julia">using DataFrames
using LinearAlgebra
using MixedModels, MixedModelsSim
using Random</code></pre><h2 id="Assemble-the-Design"><a class="docs-heading-anchor" href="#Assemble-the-Design">Assemble the Design</a><a id="Assemble-the-Design-1"></a><a class="docs-heading-anchor-permalink" href="#Assemble-the-Design" title="Permalink"></a></h2><p>We&#39;re going to do a 2 x 2 x 2 design. For concreteness, let&#39;s think of this as a linguistic design:</p><ul><li><strong>age</strong> <code>old</code> vs. <code>young</code>, <em>between subjects</em></li><li><strong>frequency</strong> <code>high</code> vs. <code>low</code>, <em>between items</em></li><li><strong>context</strong> <code>matched</code> vs. <code>unmatched</code>, <em>within both</em>.</li></ul><p>Further, let&#39;s assume we want 40 subjects and 80 items. We can specify this design as follows:</p><pre><code class="language-julia">n_subj = 40
n_item = 80
subj_btwn = Dict(:age =&gt; [&quot;old&quot;, &quot;young&quot;])
item_btwn = Dict(:frequency =&gt; [&quot;high&quot;, &quot;low&quot;])
both_win = Dict(:context =&gt; [&quot;matched&quot;, &quot;unmatched&quot;])</code></pre><pre class="documenter-example-output">Dict{Symbol,Array{String,1}} with 1 entry:
  :context =&gt; [&quot;matched&quot;, &quot;unmatched&quot;]</pre><p>and then generate it:</p><pre><code class="language-julia">rng = MersenneTwister(42)  # specify our random number generator for reproducibility
design = simdat_crossed(rng, n_subj, n_item;
                        subj_btwn = subj_btwn,
                        item_btwn = item_btwn,
                        both_win = both_win)</code></pre><pre class="documenter-example-output">25600-element Array{NamedTuple{(:subj, :age, :item, :frequency, :context, :dv),Tuple{String,String,String,String,String,Float64}},1}:
 (subj = &quot;S01&quot;, age = &quot;old&quot;, item = &quot;I001&quot;, frequency = &quot;high&quot;, context = &quot;matched&quot;, dv = -0.5560268761463861)
 (subj = &quot;S02&quot;, age = &quot;old&quot;, item = &quot;I001&quot;, frequency = &quot;high&quot;, context = &quot;matched&quot;, dv = -0.444383357109696)
 (subj = &quot;S03&quot;, age = &quot;old&quot;, item = &quot;I001&quot;, frequency = &quot;high&quot;, context = &quot;matched&quot;, dv = 0.027155338009193845)
 (subj = &quot;S04&quot;, age = &quot;old&quot;, item = &quot;I001&quot;, frequency = &quot;high&quot;, context = &quot;matched&quot;, dv = -0.29948409035891055)
 (subj = &quot;S05&quot;, age = &quot;old&quot;, item = &quot;I001&quot;, frequency = &quot;high&quot;, context = &quot;matched&quot;, dv = 1.7778610980573246)
 (subj = &quot;S06&quot;, age = &quot;old&quot;, item = &quot;I001&quot;, frequency = &quot;high&quot;, context = &quot;matched&quot;, dv = -1.14490153172882)
 (subj = &quot;S07&quot;, age = &quot;old&quot;, item = &quot;I001&quot;, frequency = &quot;high&quot;, context = &quot;matched&quot;, dv = -0.46860588216767457)
 (subj = &quot;S08&quot;, age = &quot;old&quot;, item = &quot;I001&quot;, frequency = &quot;high&quot;, context = &quot;matched&quot;, dv = 0.15614346264074028)
 (subj = &quot;S09&quot;, age = &quot;old&quot;, item = &quot;I001&quot;, frequency = &quot;high&quot;, context = &quot;matched&quot;, dv = -2.641991008076796)
 (subj = &quot;S10&quot;, age = &quot;old&quot;, item = &quot;I001&quot;, frequency = &quot;high&quot;, context = &quot;matched&quot;, dv = 1.0033099014594844)
 ⋮
 (subj = &quot;S72&quot;, age = &quot;young&quot;, item = &quot;I160&quot;, frequency = &quot;low&quot;, context = &quot;unmatched&quot;, dv = 0.4915698237574189)
 (subj = &quot;S73&quot;, age = &quot;young&quot;, item = &quot;I160&quot;, frequency = &quot;low&quot;, context = &quot;unmatched&quot;, dv = 0.9808549188059161)
 (subj = &quot;S74&quot;, age = &quot;young&quot;, item = &quot;I160&quot;, frequency = &quot;low&quot;, context = &quot;unmatched&quot;, dv = -0.3339743578698274)
 (subj = &quot;S75&quot;, age = &quot;young&quot;, item = &quot;I160&quot;, frequency = &quot;low&quot;, context = &quot;unmatched&quot;, dv = 0.000334544840247935)
 (subj = &quot;S76&quot;, age = &quot;young&quot;, item = &quot;I160&quot;, frequency = &quot;low&quot;, context = &quot;unmatched&quot;, dv = 1.7289067227993076)
 (subj = &quot;S77&quot;, age = &quot;young&quot;, item = &quot;I160&quot;, frequency = &quot;low&quot;, context = &quot;unmatched&quot;, dv = 0.8217518946287009)
 (subj = &quot;S78&quot;, age = &quot;young&quot;, item = &quot;I160&quot;, frequency = &quot;low&quot;, context = &quot;unmatched&quot;, dv = -0.9037965180550036)
 (subj = &quot;S79&quot;, age = &quot;young&quot;, item = &quot;I160&quot;, frequency = &quot;low&quot;, context = &quot;unmatched&quot;, dv = 0.950379588407989)
 (subj = &quot;S80&quot;, age = &quot;young&quot;, item = &quot;I160&quot;, frequency = &quot;low&quot;, context = &quot;unmatched&quot;, dv = -0.554130471143451)</pre><p>Note that <code>simdat_crossed</code> returns a row table, which <code>MixedModels.jl</code> can process directly. For nicely displaying it, we can also convert it to a dataframe and change the factors to use pooled arrays to save a bit of memory.</p><pre><code class="language-julia">df = pooled!(DataFrame(design))
first(df, 5)</code></pre><table class="data-frame"><thead><tr><th></th><th>subj</th><th>age</th><th>item</th><th>frequency</th><th>context</th><th>dv</th></tr><tr><th></th><th>String</th><th>String</th><th>String</th><th>String</th><th>String</th><th>Float64</th></tr></thead><tbody><p>5 rows × 6 columns</p><tr><th>1</th><td>S01</td><td>old</td><td>I001</td><td>high</td><td>matched</td><td>-0.556027</td></tr><tr><th>2</th><td>S02</td><td>old</td><td>I001</td><td>high</td><td>matched</td><td>-0.444383</td></tr><tr><th>3</th><td>S03</td><td>old</td><td>I001</td><td>high</td><td>matched</td><td>0.0271553</td></tr><tr><th>4</th><td>S04</td><td>old</td><td>I001</td><td>high</td><td>matched</td><td>-0.299484</td></tr><tr><th>5</th><td>S05</td><td>old</td><td>I001</td><td>high</td><td>matched</td><td>1.77786</td></tr></tbody></table><p>Note that <code>simdat_crossed</code> generated a column <code>dv</code> for our dependent variable that has been pre-populated with noise from a standard normal distribution (<span>$N(0,1)$</span>). Typically, we will want to scale that, but we can do that in the simulation step. Also, this dependent variable is <em>pure noise</em>: we haven&#39;t yet added in effects. Adding in effects also comes in the simulation step.</p><p>But before we get to simulating, let&#39;s fit the model to the noise, just to see how things look. We&#39;re going to use effects coding for our contrasts.</p><pre><code class="language-julia">contrasts = Dict(:age =&gt; EffectsCoding(base=&quot;young&quot;),
                 :frequency =&gt; EffectsCoding(base=&quot;high&quot;),
                 :context =&gt; EffectsCoding(base=&quot;matched&quot;))
form = @formula(dv ~ 1 + age * frequency * context +
                    (1 + frequency + context | subj) +
                    (1 + age + context | item))
m0 = fit(MixedModel, form, design; contrasts=contrasts)</code></pre><pre class="documenter-example-output">Linear mixed model fit by maximum likelihood
 dv ~ 1 + age + frequency + context + age &amp; frequency + age &amp; context + frequency &amp; context + age &amp; frequency &amp; context + (1 + frequency + context | subj) + (1 + age + context | item)
    logLik   -2 logLik      AIC         AICc        BIC     
 -36458.2206  72916.4413  72958.4413  72958.4774  73129.5986

Variance components:
               Column        Variance   Std.Dev.    Corr.
item     (Intercept)         0.00000000 0.00000000
         age: old            0.00000000 0.00000817   NaN
         context: unmatched  0.00000000 0.00001971   NaN +0.78
subj     (Intercept)         0.00003365 0.00580083
         frequency: low      0.00001548 0.00393447 +1.00
         context: unmatched  0.00003984 0.00631190 -1.00 -1.00
Residual                     1.01038817 1.00518066
 Number of obs: 25600; levels of grouping factors: 160, 80

  Fixed-effects parameters:
─────────────────────────────────────────────────────────────────────────────────────────
                                                       Coef.  Std. Error      z  Pr(&gt;|z|)
─────────────────────────────────────────────────────────────────────────────────────────
(Intercept)                                      0.00239127   0.00631577   0.38    0.7050
age: old                                         0.000740517  0.00631577   0.12    0.9067
frequency: low                                   0.00806415   0.00629776   1.28    0.2004
context: unmatched                               0.00160912   0.00632189   0.25    0.7991
age: old &amp; frequency: low                        0.0147816    0.00629776   2.35    0.0189
age: old &amp; context: unmatched                    0.00232325   0.00632189   0.37    0.7133
frequency: low &amp; context: unmatched             -0.0104732    0.00628238  -1.67    0.0955
age: old &amp; frequency: low &amp; context: unmatched  -0.00133795   0.00628238  -0.21    0.8314
─────────────────────────────────────────────────────────────────────────────────────────</pre><h2 id="Assemble-the-Random-Effects"><a class="docs-heading-anchor" href="#Assemble-the-Random-Effects">Assemble the Random Effects</a><a id="Assemble-the-Random-Effects-1"></a><a class="docs-heading-anchor-permalink" href="#Assemble-the-Random-Effects" title="Permalink"></a></h2><p>The hard part in simulating right now is specifying the random effects. We&#39;re working on making this bit easier, but you need to specify the variance-covariance matrix of the random effects. You can see what this looks like:</p><pre><code class="language-julia">vc = VarCorr(m0)</code></pre><pre class="documenter-example-output">Variance components:
               Column        Variance   Std.Dev.    Corr.
item     (Intercept)         0.00000000 0.00000000
         age: old            0.00000000 0.00000817   NaN
         context: unmatched  0.00000000 0.00001971   NaN +0.78
subj     (Intercept)         0.00003365 0.00580083
         frequency: low      0.00001548 0.00393447 +1.00
         context: unmatched  0.00003984 0.00631190 -1.00 -1.00
Residual                     1.01038817 1.00518066
</pre><pre><code class="language-julia">vc.σρ</code></pre><pre class="documenter-example-output">(item = (σ = ((Intercept) = 0.0, age: old = 8.165723160587267e-6, context: unmatched = 1.9714536085481102e-5), ρ = (NaN, NaN, 0.7798672976559413)), subj = (σ = ((Intercept) = 0.005800830618921117, frequency: low = 0.003934466008154487, context: unmatched = 0.0063119040617445965), ρ = (1.0, -0.9999980785889376, -0.9999980785889379)))</pre><p>In matrix form:</p><pre><code class="language-julia">m0.λ</code></pre><pre class="documenter-example-output">2-element Array{LinearAlgebra.LowerTriangular{Float64,Array{Float64,2}},1}:
 [0.0 0.0 0.0; -8.123637317900134e-6 0.0 0.0; -1.5295481218894385e-5 -1.2276611994126697e-5 0.0]
 [0.005770933347108016 0.0 0.0; 0.003914187912238099 0.0 0.0; -0.006279360670581915 -1.2309522191162993e-5 0.0]</pre><pre><code class="language-julia">m0.λ[1]</code></pre><pre class="documenter-example-output">3×3 LinearAlgebra.LowerTriangular{Float64,Array{Float64,2}}:
  0.0           ⋅           ⋅ 
 -8.12364e-6   0.0          ⋅ 
 -1.52955e-5  -1.22766e-5  0.0</pre><pre><code class="language-julia">m0.λ[2]</code></pre><pre class="documenter-example-output">3×3 LinearAlgebra.LowerTriangular{Float64,Array{Float64,2}}:
  0.00577093    ⋅           ⋅ 
  0.00391419   0.0          ⋅ 
 -0.00627936  -1.23095e-5  0.0</pre><p>Note that the entries in <code>m0.λ</code> are stored in the same order as the random effects are listed in <code>VarCorr(m0)</code>.  The off-diagonal elements are covariances and correspond to the correlations (the ρ&#39;s). The on-diagonal elements are just the standard deviations (the σ&#39;s). For this example, we&#39;ll just assume all the correlations and thus the covariances are 0 in order to make things simple. Then we only have to worry about the diagonal elements.</p><p>Let&#39;s assume that the variability</p><ul><li>between items<ul><li>in the intercept is 1.3 times the residual variability</li><li>in age is 0.35 times the residual variability</li><li>in context is 0.75 times the residual variability</li></ul></li><li>between subjects<ul><li>in the intercept is 1.5 times the residual variability</li><li>in frequency is 0.5 times the residual variability</li><li>in context is 0.75 times the residual variability</li></ul></li></ul><p>Then we&#39;ll have the following λ matrices:</p><pre><code class="language-julia">λitem = LowerTriangular(diagm([1.3, 0.35, 0.75]))</code></pre><pre class="documenter-example-output">3×3 LinearAlgebra.LowerTriangular{Float64,Array{Float64,2}}:
 1.3   ⋅     ⋅ 
 0.0  0.35   ⋅ 
 0.0  0.0   0.75</pre><pre><code class="language-julia">λsubj = LowerTriangular(diagm([1.5, 0.5, 0.75]))</code></pre><pre class="documenter-example-output">3×3 LinearAlgebra.LowerTriangular{Float64,Array{Float64,2}}:
 1.5   ⋅    ⋅ 
 0.0  0.5   ⋅ 
 0.0  0.0  0.75</pre><p>For the actual optimization process, MixedModels.jl actually uses a flattened version of these stored in the θ vector. (More precisely, these λ matrices are derived from the θ vector.)</p><pre><code class="language-julia">isapprox(m0.θ,  [flatlowertri(m0.λ[1]); flatlowertri(m0.λ[2])])</code></pre><pre class="documenter-example-output">true</pre><p>With that in mind, we can assemble our θ vector for simulation:</p><pre><code class="language-julia"># make sure these are in the same order as in the model summary!
θ = [flatlowertri(λitem); flatlowertri(λsubj)]</code></pre><pre class="documenter-example-output">12-element Array{Float64,1}:
 1.3
 0.0
 0.0
 0.35
 0.0
 0.75
 1.5
 0.0
 0.0
 0.5
 0.0
 0.75</pre><p>We can check that we got these right by installing these parameter values into the model:</p><pre><code class="language-julia">update!(m0; θ = θ)
VarCorr(m0)</code></pre><pre class="documenter-example-output">Variance components:
               Column       Variance Std.Dev.   Corr.
item     (Intercept)         1.666333 1.290865
         age: old            0.120784 0.347541 +0.00
         context: unmatched  0.554623 0.744730 +0.00 +0.00
subj     (Intercept)         2.218491 1.489460
         frequency: low      0.246499 0.496487 +0.00
         context: unmatched  0.554623 0.744730 +0.00 +0.00
Residual                     0.985996 0.992973
</pre><p>Looks good. The values don&#39;t exactly match the values in our parameter vector because the residual standard deviation isn&#39;t exactly 1.0.</p><h2 id="Assemble-the-Fixed-Effects"><a class="docs-heading-anchor" href="#Assemble-the-Fixed-Effects">Assemble the Fixed Effects</a><a id="Assemble-the-Fixed-Effects-1"></a><a class="docs-heading-anchor-permalink" href="#Assemble-the-Fixed-Effects" title="Permalink"></a></h2><p>The last two components we need are the residual variance and the effect sizes for the fixed effects.</p><pre><code class="language-julia">σ = 5
β = [1.0, -1.0, 2.0, -1.5, 0.3, -1.3, 1.4, 0]</code></pre><pre class="documenter-example-output">8-element Array{Float64,1}:
  1.0
 -1.0
  2.0
 -1.5
  0.3
 -1.3
  1.4
  0.0</pre><p>The entries in the β correspond to the coefficients in the model given by</p><pre><code class="language-julia">coefnames(m0)</code></pre><pre class="documenter-example-output">8-element Array{String,1}:
 &quot;(Intercept)&quot;
 &quot;age: old&quot;
 &quot;frequency: low&quot;
 &quot;context: unmatched&quot;
 &quot;age: old &amp; frequency: low&quot;
 &quot;age: old &amp; context: unmatched&quot;
 &quot;frequency: low &amp; context: unmatched&quot;
 &quot;age: old &amp; frequency: low &amp; context: unmatched&quot;</pre><h2 id="Simulate"><a class="docs-heading-anchor" href="#Simulate">Simulate</a><a id="Simulate-1"></a><a class="docs-heading-anchor-permalink" href="#Simulate" title="Permalink"></a></h2><p>Now we&#39;re ready to actually simulate our data. We can use <code>parametricbootstrap</code> to do this: the parametric bootstrap actually works by simulating new data from an existing model and then looking at how the estimates fit to that new data look. In MixedModels.jl, you can specify different parameter values, such as the ones  we made up for our fake data.</p><pre><code class="language-julia"># typically we would use a lot more simulations
# but we want to be quick in this example
sim = parametricbootstrap(MersenneTwister(12321), 20, m0; β=β, σ=σ, θ=θ)</code></pre><pre class="documenter-example-output">MixedModels.MixedModelBootstrap{Float64}(NamedTuple{(:objective, :σ, :β, :se, :θ),Tuple{Float64,Float64,NamedTuple{(Symbol(&quot;(Intercept)&quot;), Symbol(&quot;age: old&quot;), Symbol(&quot;frequency: low&quot;), Symbol(&quot;context: unmatched&quot;), Symbol(&quot;age: old &amp; frequency: low&quot;), Symbol(&quot;age: old &amp; context: unmatched&quot;), Symbol(&quot;frequency: low &amp; context: unmatched&quot;), Symbol(&quot;age: old &amp; frequency: low &amp; context: unmatched&quot;)),NTuple{8,Float64}},StaticArrays.SArray{Tuple{8},Float64,1,8},StaticArrays.SArray{Tuple{12},Float64,1,12}}}[(objective = 158214.18890810877, σ = 4.980380428969068, β = ((Intercept) = 0.7092608509933476, age: old = -1.702466800110171, frequency: low = 2.344663132101154, context: unmatched = -1.6431406868085092, age: old &amp; frequency: low = 0.031781568587227284, age: old &amp; context: unmatched = -1.3032188215794585, frequency: low &amp; context: unmatched = 1.6087573910613517, age: old &amp; frequency: low &amp; context: unmatched = -0.006752251958283888), se = [0.9853588922878578, 0.8433615071703952, 0.5876127291919876, 0.4876032411100964, 0.29260075986459383, 0.4006120923795719, 0.2797066066822692, 0.031127377681056674], θ = [1.3492461814941892, -0.0227068873234021, -0.06832715281520965, 0.3806830739229168, 0.08532536710198335, 0.6974688091439588, 1.4893463595191896, -0.027613718950290928, 0.06384852777691766, 0.446683685877774, 0.12399433560253798, 0.7035951730252804]), (objective = 158397.928227836, σ = 4.99688649081555, β = ((Intercept) = 3.12815475681822, age: old = -0.4207353663198776, frequency: low = 1.534046212109804, context: unmatched = -1.925386961327556, age: old &amp; frequency: low = 0.18558497151332257, age: old &amp; context: unmatched = -1.2523643276771328, frequency: low &amp; context: unmatched = 1.5552969053913899, age: old &amp; frequency: low &amp; context: unmatched = -0.011848473142110762), se = [1.013969979404553, 0.8726450857049669, 0.6165413151650284, 0.48771470229819536, 0.3368939295697882, 0.40368266311670903, 0.27546557861320464, 0.03123054056759719], θ = [1.3533596581745488, 0.010948712028506589, -0.0009926043388246571, 0.3506152173896483, -0.016659515609491173, 0.6926161150314804, 1.5411740485179475, 0.01398786069284777, -0.007714810694525382, 0.5466248202785229, -0.017880328053534934, 0.7201505680092121]), (objective = 158677.14197476275, σ = 5.020099708623371, β = ((Intercept) = 1.089636743260995, age: old = -0.48148373940821315, frequency: low = 2.936868749778949, context: unmatched = -0.6224475618306543, age: old &amp; frequency: low = 0.2641183326940158, age: old &amp; context: unmatched = -1.6963011209300154, frequency: low &amp; context: unmatched = 1.4839773451015572, age: old &amp; frequency: low &amp; context: unmatched = -0.011265845938406151), se = [0.9706479024316873, 0.8267396544238119, 0.6100812737892418, 0.5875871611598884, 0.3369573657425955, 0.4966787016894542, 0.31552079008684925, 0.03137562317889607], θ = [1.3274473215649403, -0.0611417109230168, -0.06878411938994114, 0.34086755793297735, -0.10410823361808069, 0.7811721717589898, 1.4514221423506624, -0.10454621031425732, 0.0437123303014739, 0.5351689829113166, 0.09347618816518755, 0.877111682662173]), (objective = 158675.98049327926, σ = 5.031635459699392, β = ((Intercept) = 1.9103677647264181, age: old = -0.8745865537197998, frequency: low = 2.200335517021045, context: unmatched = -2.6145612615660356, age: old &amp; frequency: low = 0.8354338289338108, age: old &amp; context: unmatched = -2.1924058724124817, frequency: low &amp; context: unmatched = 1.4102366846411611, age: old &amp; frequency: low &amp; context: unmatched = 0.06785373775119288), se = [0.9422096663366618, 0.8160686467912445, 0.5602587454292901, 0.4848554296887028, 0.3034779114997266, 0.3909095859132555, 0.2885540547885958, 0.0314477216231212], θ = [1.2310161235712307, -0.006777214621871784, 0.13071548817892997, 0.33717256456512107, -0.11198364534355755, 0.7002352323934004, 1.429822917003058, -0.03220875945296647, -0.030446706626654482, 0.4795768573193222, -0.0006279060606128143, 0.6919617080680691]), (objective = 158856.62494365213, σ = 5.040878489034377, β = ((Intercept) = -1.3417588250863044, age: old = -1.2602769884708558, frequency: low = 1.887854734649844, context: unmatched = -1.3668720375904269, age: old &amp; frequency: low = 0.045471425126090086, age: old &amp; context: unmatched = -1.4302235904804144, frequency: low &amp; context: unmatched = 1.308606201988786, age: old &amp; frequency: low &amp; context: unmatched = 0.05799319738593691), se = [0.935494060420361, 0.7618731278290691, 0.6236241925697951, 0.5588417297478748, 0.3069342916369554, 0.47547339444145337, 0.2953332457090926, 0.03150549055646486], θ = [1.4075317278328203, -5.562842233389126e-5, 0.013334436943744945, 0.35431777031267453, 0.03855888524054443, 0.7357224482390323, 1.3272314244796255, 0.006172720072070523, 0.21536662564709536, 0.4802753864847291, 0.03549293456676325, 0.8130107973521434]), (objective = 158825.81933070303, σ = 5.040639752369733, β = ((Intercept) = 0.8741809652121935, age: old = -0.7870347398366326, frequency: low = 2.311855084632217, context: unmatched = -1.3790080879903617, age: old &amp; frequency: low = 0.7085052457397255, age: old &amp; context: unmatched = -1.8397538386358898, frequency: low &amp; context: unmatched = 1.6828378139168727, age: old &amp; frequency: low &amp; context: unmatched = 0.052291272964083736), se = [0.9785997258565008, 0.8633188644908056, 0.5614312549148444, 0.5475684904920259, 0.3207290013953557, 0.4575672695943693, 0.3024168439327643, 0.03150399845231083], θ = [1.206241591148608, -0.04235548485120861, 0.04244797568298349, 0.34071477409663503, 0.019043063315840526, 0.7533282702029306, 1.5115071742545247, 0.026553509213617002, 0.09349957272064764, 0.5109969106168551, 0.17601695314616997, 0.7850911547331078]), (objective = 158395.168228772, σ = 4.994689024841527, β = ((Intercept) = 0.6250490338352256, age: old = 0.5099540370913777, frequency: low = 2.0587564150087263, context: unmatched = -0.6431905845192118, age: old &amp; frequency: low = 1.2186989407092823, age: old &amp; context: unmatched = -1.361986309060196, frequency: low &amp; context: unmatched = 1.7259445349960065, age: old &amp; frequency: low &amp; context: unmatched = -0.008879268442226975), se = [0.9786224704993558, 0.84669976185849, 0.5911895223947907, 0.540909328325095, 0.3297022874579271, 0.4531903926585434, 0.29694420094189594, 0.031216806405259548], θ = [1.2951971839865735, 0.005967422868911261, 0.027181787578448448, 0.3648172861957296, 0.06833083516871366, 0.7442232876714016, 1.4930754255394176, -0.16392457221255666, 0.04692762018420868, 0.502027658112362, -0.08920516594954342, 0.8033271814643532]), (objective = 158372.62212537284, σ = 4.992047959335251, β = ((Intercept) = 0.8194803654398316, age: old = 0.13425180051045027, frequency: low = 2.6544659066452927, context: unmatched = -0.5628222799546085, age: old &amp; frequency: low = 0.33896919598007286, age: old &amp; context: unmatched = -1.693108625762624, frequency: low &amp; context: unmatched = 1.1741392804561874, age: old &amp; frequency: low &amp; context: unmatched = -0.014481410011228121), se = [1.0706468109823897, 0.9656411355826887, 0.5552736599743752, 0.5283697346355063, 0.3074199836104418, 0.42834966084567805, 0.31090931674187905, 0.031200299745845317], θ = [1.2275527309257703, 0.043303415553214014, -0.04321133908370065, 0.3635764483552765, 0.013424653492132007, 0.782514247153074, 1.7097480301008872, 0.026488698783565218, 0.07669996321559897, 0.48221223289072507, -0.009156424937427295, 0.7615295984252223]), (objective = 158206.56803164526, σ = 4.974983551514383, β = ((Intercept) = 1.4962640098490099, age: old = -2.1545473563238247, frequency: low = 0.9074624201626308, context: unmatched = -1.3009098610992624, age: old &amp; frequency: low = -0.008986092725776905, age: old &amp; context: unmatched = -1.6058607945705492, frequency: low &amp; context: unmatched = 1.856759773970931, age: old &amp; frequency: low &amp; context: unmatched = 0.01800636415883885), se = [0.9888774130778119, 0.8706484683532488, 0.5918373857655169, 0.5650528382989858, 0.3611394585828685, 0.49277658865849666, 0.2782494539713283, 0.031093647196964898], θ = [1.2470485549908361, -0.023969350948547494, 0.028369276329747117, 0.36514509458390004, 0.006867420102641856, 0.702423986132113, 1.5427477277609485, -0.07971188493594683, -0.07217104698797863, 0.587473864268677, 0.08220506844289137, 0.8773796780008843]), (objective = 158623.37726819588, σ = 5.0183018063051605, β = ((Intercept) = 1.8054296398489842, age: old = -0.6638090056693642, frequency: low = 1.1095106731517275, context: unmatched = -1.2466968438262789, age: old &amp; frequency: low = 0.17083052659076256, age: old &amp; context: unmatched = -0.36971280585411365, frequency: low &amp; context: unmatched = 1.294183993892851, age: old &amp; frequency: low &amp; context: unmatched = -0.03596556509814446), se = [0.9793700263043709, 0.8422084415222607, 0.5956273895133225, 0.5159077659888988, 0.3239157262175942, 0.4137890739171925, 0.3097146267805086, 0.031364386289407256], θ = [1.3075228891122552, -0.03964750248806122, -0.07699593573357348, 0.3473364413837769, -0.022068284716910032, 0.772510894198699, 1.4795438756224744, 0.017942229467058927, 0.09672126649123369, 0.5184108345525378, -0.0950768834767308, 0.722772222488681]), (objective = 158430.1457875932, σ = 5.0018329719749, β = ((Intercept) = 0.6611881790192641, age: old = -2.225309589667987, frequency: low = 2.580997233939216, context: unmatched = -2.14345347848899, age: old &amp; frequency: low = 0.7571594719726172, age: old &amp; context: unmatched = -1.3592492748540401, frequency: low &amp; context: unmatched = 1.5384679773005212, age: old &amp; frequency: low &amp; context: unmatched = -0.01923760980723519), se = [0.9792965517500418, 0.848145178169563, 0.5851964138065306, 0.5435802881808074, 0.3205984243764615, 0.4733378241652335, 0.26908755554479585, 0.031261456074843125], θ = [1.2858661670545097, 0.003153558975617673, 0.048966244731590655, 0.3473734556410988, -0.021246698187403615, 0.6737753507856984, 1.4955834420735215, -0.023512312488288875, -0.08699542606932292, 0.5144402207793717, 0.09208624493224005, 0.8350193834834205]), (objective = 158296.24710307326, σ = 4.989722808427098, β = ((Intercept) = 2.271183865555212, age: old = -1.8224380674113054, frequency: low = 2.0073144627487864, context: unmatched = -1.261156188573241, age: old &amp; frequency: low = -0.021418885143962355, age: old &amp; context: unmatched = -1.366844834966647, frequency: low &amp; context: unmatched = 1.000256921943808, age: old &amp; frequency: low &amp; context: unmatched = 0.02474624284761623), se = [0.9578291298268771, 0.7945819956725217, 0.6057817063505259, 0.5296848389119792, 0.2844211343202949, 0.43998120288352555, 0.2965722876132627, 0.031185767552669365], θ = [1.3951849639924911, -0.038070575028418, 0.17388202639491615, 0.3265806070967993, 0.029581939757393483, 0.7265493433686037, 1.4041038866919067, 0.0349667454127463, 0.03191866785624222, 0.44892412517802127, -0.01339800748122362, 0.7859377750042471]), (objective = 157910.50995531408, σ = 4.956458782776837, β = ((Intercept) = 1.6818693979093398, age: old = 0.41543517254324314, frequency: low = 2.7522976231806573, context: unmatched = -1.4602701198358343, age: old &amp; frequency: low = 0.1187915349054207, age: old &amp; context: unmatched = -0.9680562719661115, frequency: low &amp; context: unmatched = 1.8808675135340087, age: old &amp; frequency: low &amp; context: unmatched = 0.03060261398273425), se = [0.9701859564256243, 0.8499835992661403, 0.5619007938143814, 0.49247661563762946, 0.31135804320206445, 0.4209920752842714, 0.25740729936479634, 0.03097786739235523], θ = [1.2389095243817252, 0.011826896568620876, 0.008768937899939915, 0.33136045475514186, -0.010058205467365945, 0.6520042920846516, 1.514798160295623, 0.016398786046698657, 0.08092660578883384, 0.507277908854734, -0.04329830373371644, 0.7520700024570262]), (objective = 158539.11906389028, σ = 5.008203694891104, β = ((Intercept) = 0.5943594425203551, age: old = -1.7273419635819498, frequency: low = 2.0740992473386908, context: unmatched = -2.406740153118366, age: old &amp; frequency: low = 0.19676230525335678, age: old &amp; context: unmatched = -1.526525148924735, frequency: low &amp; context: unmatched = 1.376720240940239, age: old &amp; frequency: low &amp; context: unmatched = 0.07565949296516186), se = [1.1070187026236744, 0.991506862181357, 0.5924260450235956, 0.46712110674512813, 0.3294906199186878, 0.3542194644638885, 0.3061216572853801, 0.0313012730930694], θ = [1.2971090114137143, -0.02286348694011433, -0.009473127321377214, 0.3683181702693967, -0.02328548337569585, 0.7687013884215026, 1.750531767845279, -0.011231454622833772, 0.08700969799172004, 0.5243340202863661, -0.012900321961058956, 0.6239648715812022]), (objective = 158656.89886446242, σ = 5.030228713999672, β = ((Intercept) = 0.297861982562384, age: old = -1.048189299205342, frequency: low = 0.9893992252268877, context: unmatched = -1.439739189840251, age: old &amp; frequency: low = 0.21060418703034373, age: old &amp; context: unmatched = -1.7914168493362765, frequency: low &amp; context: unmatched = 1.9700078898768505, age: old &amp; frequency: low &amp; context: unmatched = 0.02482122057482876), se = [1.078025084519501, 0.9767651447316913, 0.5438875736244261, 0.49983154608296576, 0.29621910446332383, 0.42250502214247637, 0.26890423390048096, 0.031438929462497954], θ = [1.1912516492962268, -0.009236077651706498, -0.04777807841867722, 0.32142961398671926, -0.10104809424077106, 0.6621871998721505, 1.7209342858111087, -0.06768651749154475, -0.043338175681008756, 0.4669199366727319, -0.030504295159963783, 0.7472984304864231]), (objective = 158450.81210062775, σ = 5.002239865274206, β = ((Intercept) = 0.16564589498993035, age: old = -0.9801968173360951, frequency: low = 2.5135087325547887, context: unmatched = -1.730726987169717, age: old &amp; frequency: low = 0.6920406624831325, age: old &amp; context: unmatched = -1.6703616793898186, frequency: low &amp; context: unmatched = 1.5928086846905678, age: old &amp; frequency: low &amp; context: unmatched = 0.007268979865354859), se = [0.9622795033382485, 0.8198469480316163, 0.6062053790705658, 0.5317866442650916, 0.3371233264906659, 0.4422356890533294, 0.29698832971867145, 0.03126399915796379], θ = [1.315401230173089, 0.0026574381427073804, 0.013322171730058003, 0.3274107091630418, 0.03160143002333093, 0.7460306217692284, 1.4464520957787352, -0.02503953412086582, -0.12371431647220289, 0.5531788307270762, 0.007823641000412265, 0.7789607939885703]), (objective = 158257.08706659524, σ = 4.9920692604482095, β = ((Intercept) = 1.8069239713236482, age: old = -0.9704064263703359, frequency: low = 2.1462340223267318, context: unmatched = -1.799351518655038, age: old &amp; frequency: low = 0.5786783926646396, age: old &amp; context: unmatched = -1.2948983848264901, frequency: low &amp; context: unmatched = 1.432896870223341, age: old &amp; frequency: low &amp; context: unmatched = -0.011983598918667614), se = [0.9936155555370447, 0.8785404040986108, 0.5407229056598026, 0.4947529413361857, 0.27738534593363384, 0.40882317791473766, 0.2803882115434402, 0.03120043287780131], θ = [1.2190328624879296, -0.0029676519800376196, -0.11717357404715947, 0.32068779845716194, 0.006828376047407708, 0.6962226620503593, 1.556653611292048, 0.008401850158961874, -0.0794435573369619, 0.43861033210330846, -0.10939028912063394, 0.7177288075067]), (objective = 158736.9725417718, σ = 5.033632016189429, β = ((Intercept) = 1.3330239434893607, age: old = -0.1388052728041904, frequency: low = 2.018396385108629, context: unmatched = -0.41126818482624516, age: old &amp; frequency: low = 0.536857915348935, age: old &amp; context: unmatched = -1.0782015525251596, frequency: low &amp; context: unmatched = 0.9549529833930747, age: old &amp; frequency: low &amp; context: unmatched = 0.07080388971746268), se = [0.9232877556360714, 0.7913752065967057, 0.5774439536702637, 0.5023251236192988, 0.3274995534897358, 0.39140837344476903, 0.316417065290273, 0.03146020010118394], θ = [1.2400929461380137, 0.014853939802739665, -0.082504769121309, 0.3306080085141202, -0.045523036636694936, 0.7855591434894703, 1.3854609565440457, -0.05795346198158591, 0.08678730964942677, 0.5266908251521522, -0.05158520192615632, 0.685853046645405]), (objective = 158396.15592762025, σ = 5.003469470889273, β = ((Intercept) = 2.1841867108953683, age: old = -0.013574072024322948, frequency: low = 1.497931573156769, context: unmatched = -0.897708211580246, age: old &amp; frequency: low = 0.20002121604563097, age: old &amp; context: unmatched = -0.9627498482938733, frequency: low &amp; context: unmatched = 1.1522746649563549, age: old &amp; frequency: low &amp; context: unmatched = 0.029881762444638978), se = [1.0204334722915873, 0.8866612322795959, 0.5916695385933111, 0.4768333548842115, 0.3081501457891633, 0.3945608544999945, 0.2695731786705333, 0.03127168419305796], θ = [1.3152085042451667, 0.016730844275807327, 0.08125493339531192, 0.31466255025747975, 0.04820901948770723, 0.670272204257274, 1.568272663909613, -0.03313649574690759, -0.055698013513737044, 0.4995701505326714, -0.10885233480228573, 0.6923898624018244]), (objective = 158648.43519164898, σ = 5.028412853221209, β = ((Intercept) = 1.2111526639700483, age: old = -2.073805160440759, frequency: low = 1.8326193486444062, context: unmatched = -1.0554329598095031, age: old &amp; frequency: low = 0.5686217675347324, age: old &amp; context: unmatched = -0.5847200579393589, frequency: low &amp; context: unmatched = 1.555267324993486, age: old &amp; frequency: low &amp; context: unmatched = -0.054247529956413465), se = [0.8904645193987761, 0.7515984229057117, 0.5701276074558591, 0.5199755848500472, 0.31147811767236816, 0.43040653534344064, 0.29344934141911166, 0.03142758033263256], θ = [1.2432176646803974, -0.026770688732013395, 0.08224172036016553, 0.3192916746875455, 0.055911966395458354, 0.7271655134028185, 1.3163787220768306, 0.05341072376461632, 0.056296517045269265, 0.49965126073457466, -0.11084295529450433, 0.7533515798678685])], LinearAlgebra.LowerTriangular{Float64,Array{Float64,2}}[[1.3 0.0 0.0; 0.0 0.35 0.0; 0.0 0.0 0.75], [1.5 0.0 0.0; 0.0 0.5 0.0; 0.0 0.0 0.75]], [[1, 2, 3, 5, 6, 9], [1, 2, 3, 5, 6, 9]], [0.0, -Inf, -Inf, 0.0, -Inf, 0.0, 0.0, -Inf, -Inf, 0.0, -Inf, 0.0], (item = (&quot;(Intercept)&quot;, &quot;age: old&quot;, &quot;context: unmatched&quot;), subj = (&quot;(Intercept)&quot;, &quot;frequency: low&quot;, &quot;context: unmatched&quot;)))</pre><h2 id="See-your-power-and-profit!"><a class="docs-heading-anchor" href="#See-your-power-and-profit!">See your power and profit!</a><a id="See-your-power-and-profit!-1"></a><a class="docs-heading-anchor-permalink" href="#See-your-power-and-profit!" title="Permalink"></a></h2><p>Finally, we can turn this into a power table:</p><pre><code class="language-julia">ptbl = power_table(sim)</code></pre><pre class="documenter-example-output">8-element Array{NamedTuple{(:coefname, :power),Tuple{Symbol,Float64}},1}:
 (coefname = Symbol(&quot;age: old &amp; frequency: low&quot;), power = 0.3)
 (coefname = Symbol(&quot;frequency: low &amp; context: unmatched&quot;), power = 1.0)
 (coefname = Symbol(&quot;age: old&quot;), power = 0.25)
 (coefname = Symbol(&quot;context: unmatched&quot;), power = 0.75)
 (coefname = Symbol(&quot;frequency: low&quot;), power = 0.85)
 (coefname = Symbol(&quot;age: old &amp; context: unmatched&quot;), power = 0.9)
 (coefname = Symbol(&quot;(Intercept)&quot;), power = 0.2)
 (coefname = Symbol(&quot;age: old &amp; frequency: low &amp; context: unmatched&quot;), power = 0.15)</pre><p>We can of course convert the row table into a DataFrame:</p><pre><code class="language-julia">DataFrame(ptbl)</code></pre><table class="data-frame"><thead><tr><th></th><th>coefname</th><th>power</th></tr><tr><th></th><th>Symbol</th><th>Float64</th></tr></thead><tbody><p>8 rows × 2 columns</p><tr><th>1</th><td>age: old &amp; frequency: low</td><td>0.3</td></tr><tr><th>2</th><td>frequency: low &amp; context: unmatched</td><td>1.0</td></tr><tr><th>3</th><td>age: old</td><td>0.25</td></tr><tr><th>4</th><td>context: unmatched</td><td>0.75</td></tr><tr><th>5</th><td>frequency: low</td><td>0.85</td></tr><tr><th>6</th><td>age: old &amp; context: unmatched</td><td>0.9</td></tr><tr><th>7</th><td>(Intercept)</td><td>0.2</td></tr><tr><th>8</th><td>age: old &amp; frequency: low &amp; context: unmatched</td><td>0.15</td></tr></tbody></table></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Home</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Saturday 20 February 2021 23:27">Saturday 20 February 2021</span>. Using Julia version 1.5.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
